# ipmoveOvh

*ipmoveOvh* is a simple tool dedicated to move an OVH **FailOver IP** from one 
instance to another.

[![Actions Status](https://github.com/tristan-weil/ipmoveOvh/workflows/build/badge.svg?branch=master)](https://github.com/tristan-weil/ansible-role-nomad/actions)

## Configuration

*ipmoveOvh* uses [go-ovh](https://github.com/ovh/go-ovh) and thus inherits its 
[configuration](https://github.com/ovh/go-ovh#configuration) methods (environment variables and/or configuration files) 
from it.

As *ipmoveOvh* is meant to be used in an automatic process, all tokens must be generated by an external tool.
You can use https://eu.api.ovh.com/createToken/ with the following values:
- Validity: unlimited (if needed)
- Rights:
    - GET /cloud/project
    - GET /cloud/project/\*
    - POST /cloud/project/\*/ip/failover/\*/attach

## Options

| Option | Default value | Allowed values | Description | Mandatory | Conflict with |
| ------ | ------------- | -------------- | ----------- | --------- | ------------- |
| `-log-level` | info | error, warn, info, trace, debug | The log level | | |
| `-project` | | | The name of your OVH project/service | X | `project-id` |
| `-project-id` | | | The id of your OVH project/service | X | `project` |
| `-instance` | | | The name of the instance to attach the FailOver IP to | X | `instance-id` |
| `-instance-id` | | | The id of the instance to attach the FailOver IP to | X | `instance` |
| `-ip` | | | The FailOver IP to move | X | `ip-id` |
| `-ip-id` | | | The id of the FailOver IP to move | X | `ip` |

Using the `*-id` options will reduce the number of requests sent to the OVH API and the size of the responses.
Thus the time needed to move the IP is reduced.

## Example

To move IP `xx.xx.xx.xx` to `node-02`

```
ipmoveOvh -project t18s -ip xx.xx.xx.xx -instance node-02 -log-level debug
```

## Todo

None.

## License

See [LICENSE.md](https://github.com/tristan-weil/ipmoveOvh/blob/master/LICENSE.md)
